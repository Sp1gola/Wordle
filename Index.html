<html lang="">
    <head>
        <meta charset="UTF-8">
        <title>Sp1gola's Wordle</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
    <h1>Welcome to Sp1gola's Wordle</h1>
    <div id="d1">
        <label for="myfile">Select a file:</label>
        <input type="file" id="myfile" name="myfile">
        <input type="Button" value="Load" onclick="leggiFile()">
    </div>
        <table id="t"></table>
    </body>
    <script>
        let contenuto = "";
        let id = 0;
        let currentIndex = 0;
        let tentativo = 1;
        let soluzione = "";
        let arraySoluzione;

        function tabella() {
            for(let i = 0 ; i < 6; i++){
                contenuto = contenuto + "<tr>" +
                    "<td><input type='button' style='width:100%; height:100%' id='"+id+"'></td>" +
                    "<td><input type='button' style='width:100%; height:100%' id='"+(id+1)+"'></td>" +
                    "<td><input type='button' style='width:100%; height:100%' id='"+(id+2)+"'></td>" +
                    "<td><input type='button' style='width:100%; height:100%' id='"+(id+3)+"'></td>" +
                    "<td><input type='button' style='width:100%; height:100%' id='"+(id+4)+"'></td>" +
                    "</tr>";
                id += 5;
            }
            document.getElementById("t").innerHTML = contenuto;
        }

        document.addEventListener('keydown', (event) => {
            const key = event.key;
            let bottone = document.getElementById(currentIndex);

            if (/^[a-zA-Z]$/.test(key) && currentIndex < (tentativo*5)) {
                bottone.value = key.toUpperCase();
                currentIndex++;
            }

            if(key === 'Enter' && currentIndex === tentativo * 5){
                if(tentativo === 6){
                    alert("hai perso, la soluzione era: "+soluzione);
                }
                controlloRiga();
                tentativo++;
            }

            if (key === 'Backspace') {
                if (currentIndex !== (tentativo*5-5)) {
                    currentIndex--;
                    let bottone = document.getElementById(currentIndex);
                    if (!bottone.disabled) {
                        bottone.value = '';
                    }
                }
                event.preventDefault();
            }
        });
        function controlloRiga(){
            let bottone = [];
            let j = 0;

            for(let i = (currentIndex-5); i < currentIndex; i++){
                bottone[j] = document.getElementById(i);
                bottone[j].disabled = true;
                j++;
            }
        }
        function leggiFile(){
            let file = document.querySelector('input').files[0];
            let reader = new FileReader();

            reader.onload = function(event) {
                let testo = event.target.result;
                let listaParole = testo.split(';');
                soluzione = listaParole[Math.floor(Math.random() * listaParole.length)];
                arraySoluzione= soluzione.split('');
                alert(soluzione);

                tabella();
                document.getElementById("d1").style.display="none";
                document.querySelector('input[type="button"]').disabled = true;
            };
            reader.readAsText(file);
        }
    </script>
</html>